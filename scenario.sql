-- SCENARIO
--    This is a schema for a shopping mall operator with five tenants. Each has a different negotiated
--    revenue share that the tenant must pay to the shopping mall operator. The revenue share for a
--    given month may be calculated by multiplying the tenant's revenue share times the tenant's revenue
--    for the month.
--
-- INSTRUCTIONS
-- 1) Build a query which shows both the total revenue and the mall operator's total revenue share by year
--    and month. The columns should be 'Year', 'Month', 'Total Revenue', and 'Revenue Share'
-- 2) Click 'Run SQL' on the right-hand side to test your query (it may take 60 seconds)
-- 3) Once you are satisfied with the results, copy the query and email it to me.
-- 4) Build a second query which shows the total revenue for 2015 by tenant. Ensure that every tenant is
--    included in the results even if they had no sales.

create table tenant (
  id BIGSERIAL PRIMARY KEY,
  name VARCHAR(50) NOT NULL,
  revenue_share NUMERIC(15,2) NOT NULL
);

insert into tenant (name, revenue_share) values ('Apple', .03);
insert into tenant (name, revenue_share) values ('Barnes and Noble', .05);
insert into tenant (name, revenue_share) values ('California Pizza Kitchen', .05);
insert into tenant (name, revenue_share) values ('Disney', .03);
insert into tenant (name, revenue_share) values ('Express', .06);
insert into tenant (name, revenue_share) values ('The GAP', .04);

create table tenant_sales(
  id BIGSERIAL PRIMARY KEY,
  tenant_id BIGINT NOT NULL REFERENCES tenant(id),
  year INTEGER NOT NULL,
  month SMALLINT NOT NULL,
  revenue numeric(15,2)
);

INSERT INTO tenant_sales
    (tenant_id, year, month, revenue)
VALUES
 (1,2013,1,417416.95),
 (1,2013,2,451661.35),
 (1,2013,3,333335.06),
 (1,2013,4,845193.60),
 (1,2013,5,1242439.01),
 (1,2013,6,1843065.84),
 (1,2013,7,1252995.30),
 (1,2013,8,1236388.36),
 (1,2013,9,201378.23),
 (1,2013,10,726838.22),
 (1,2013,11,320109.98),
 (1,2013,12,1634952.83),
 (2,2013,1,432543.13),
 (2,2013,2,535486.24),
 (2,2013,3,191735.77),
 (2,2013,4,519069.44),
 (2,2013,5,358393.05),
 (2,2013,6,712528.46),
 (2,2013,7,135081.66),
 (2,2013,8,728952.52),
 (2,2013,9,443067.55),
 (2,2013,10,81254.55),
 (2,2013,11,208.38),
 (2,2013,12,320577.51),
 (3,2013,1,115114.34),
 (3,2013,2,24183.30),
 (3,2013,3,87881.67),
 (3,2013,4,438692.99),
 (3,2013,5,164773.97),
 (3,2013,6,333092.51),
 (3,2013,7,286801.98),
 (3,2013,8,179418.31),
 (3,2013,9,345634.85),
 (3,2013,10,66810.91),
 (3,2013,11,507701.72),
 (3,2013,12,417907.51),
 (4,2013,1,192043.07),
 (4,2013,2,384816.90),
 (4,2013,3,423064.69),
 (4,2013,4,496090.82),
 (4,2013,5,104097.55),
 (4,2013,6,613255.14),
 (4,2013,7,257243.60),
 (4,2013,8,512799.31),
 (4,2013,9,82894.48),
 (4,2013,10,68217.91),
 (4,2013,11,37682.96),
 (4,2013,12,559982.85),
 (5,2013,1,511719.94),
 (5,2013,2,628922.45),
 (5,2013,3,25452.14),
 (5,2013,4,296807.79),
 (5,2013,5,834433.80),
 (5,2013,6,877225.55),
 (5,2013,7,708493.50),
 (5,2013,8,687146.59),
 (5,2013,9,951092.58),
 (5,2013,10,393756.76),
 (5,2013,11,471579.68),
 (5,2013,12,710655.94),
 (1,2014,1,612176.79),
 (1,2014,2,1256977.80),
 (1,2014,3,502900.38),
 (1,2014,4,947514.67),
 (1,2014,5,973676.01),
 (1,2014,6,1843357.84),
 (1,2014,7,912000.41),
 (1,2014,8,340148.05),
 (1,2014,9,24303.53),
 (1,2014,10,594082.82),
 (1,2014,11,772436.46),
 (1,2014,12,314017.94),
 (2,2014,1,57806.13),
 (2,2014,2,227794.25),
 (2,2014,3,616731.49),
 (2,2014,4,482285.38),
 (2,2014,5,317639.81),
 (2,2014,6,359539.43),
 (2,2014,7,246725.73),
 (2,2014,8,738733.17),
 (2,2014,9,119534.64),
 (2,2014,10,694040.29),
 (2,2014,11,266706.25),
 (2,2014,12,861113.29),
 (3,2014,1,236799.79),
 (3,2014,2,117734.35),
 (3,2014,3,147677.78),
 (3,2014,4,271862.44),
 (3,2014,5,116573.52),
 (3,2014,6,22090.91),
 (3,2014,7,90236.81),
 (3,2014,8,405923.19),
 (3,2014,9,6499.51),
 (3,2014,10,331560.19),
 (3,2014,11,482602.38),
 (3,2014,12,190321.65),
 (4,2014,1,291899.90),
 (4,2014,2,375115.72),
 (4,2014,3,344275.34),
 (4,2014,4,144532.55),
 (4,2014,5,486910.75),
 (4,2014,6,553307.15),
 (4,2014,7,303129.64),
 (4,2014,8,315672.87),
 (4,2014,9,405826.29),
 (4,2014,10,330454.04),
 (4,2014,11,101166.69),
 (4,2014,12,275613.22),
 (5,2014,1,164102.69),
 (5,2014,2,1712.61),
 (5,2014,3,202045.26),
 (5,2014,4,862792.66),
 (5,2014,5,754499.54),
 (5,2014,6,542650.71),
 (5,2014,7,508130.69),
 (5,2014,8,341420.90),
 (5,2014,9,682163.08),
 (5,2014,10,601873.50),
 (5,2014,11,572665.12),
 (5,2014,12,689670.69),
 (1,2015,1,745563.39),
 (1,2015,2,87819.60),
 (1,2015,3,885334.45),
 (1,2015,4,126384.59),
 (1,2015,5,166408.01),
 (1,2015,6,1467042.73),
 (1,2015,7,576633.72),
 (1,2015,8,2262974.44),
 (1,2015,9,720514.38),
 (1,2015,10,538036.86),
 (1,2015,11,871954.45),
 (1,2015,12,2607839.80),
 (2,2015,1,423498.93),
 (2,2015,2,594829.18),
 (2,2015,3,286850.96),
 (2,2015,4,663924.73),
 (2,2015,5,488104.14),
 (2,2015,6,973946.84),
 (2,2015,7,827458.69),
 (2,2015,8,7743.17),
 (2,2015,9,696361.47),
 (2,2015,10,541928.44),
 (2,2015,11,878012.02),
 (2,2015,12,704789.93),
 (3,2015,1,169832.99),
 (3,2015,2,173311.85),
 (3,2015,3,21784.21),
 (3,2015,4,242954.67),
 (3,2015,5,413244.72),
 (3,2015,6,184568.54),
 (3,2015,7,55277.49),
 (3,2015,8,9377.96),
 (3,2015,9,228544.65),
 (3,2015,10,273437.46),
 (3,2015,11,42180.90),
 (3,2015,12,405631.26),
 (4,2015,1,109940.79),
 (4,2015,2,288714.62),
 (4,2015,3,432654.72),
 (4,2015,4,199253.51),
 (4,2015,5,104197.69),
 (4,2015,6,52481.64),
 (4,2015,7,399528.18),
 (4,2015,8,166012.32),
 (4,2015,9,192316.07),
 (4,2015,10,227360.69),
 (4,2015,11,120755.54),
 (4,2015,12,708606.89),
 (5,2015,1,315559.64),
 (5,2015,2,418859.17),
 (5,2015,3,421200.88),
 (5,2015,4,833248.05),
 (5,2015,5,692837.13),
 (5,2015,6,479779.81),
 (5,2015,7,924945.24),
 (5,2015,8,49110.78),
 (5,2015,9,614520.21),
 (5,2015,10,207704.03),
 (5,2015,11,1130069.52),
 (5,2015,12,1160450.27)
;
